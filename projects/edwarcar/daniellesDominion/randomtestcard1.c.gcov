        -:    0:Source:randomtestcard1.c
        -:    0:Graph:randomtestcard1.gcno
        -:    0:Data:randomtestcard1.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:#include "dominion.h"
        -:    2:#include "rngs.h"
        -:    3:#include <stdio.h>
        -:    4:#include <math.h>
        -:    5:#include <stdlib.h>
        -:    6:#include <assert.h>
        -:    7:#include <time.h>
        -:    8:
        -:    9:#define MAX_TESTS 500 
        -:   10:
        -:   11:
function main called 1 returned 100% blocks executed 84%
        1:   12:int main() {
        -:   13:    
        -:   14:    //declare variables
        -:   15:    struct gameState game;
        -:   16:    int players; 
        -:   17:    int player; 
        1:   18:    int k[10] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
        -:   19:    int seed;  
        -:   20:    int coinBonus;
        -:   21:    int handPos;
        1:   22:    int choice1 = 0;
        1:   23:    int choice2 = 0; 
        1:   24:    int choice3 = 0; 
        1:   25:    int test_failed = 0; 	
        1:   26:    srand(time(NULL));
call    0 returned 100%
call    1 returned 100%
        -:   27:
        1:   28:printf("/*********************** Randomly Testing Smithy Card **************************/\n");
call    0 returned 100%
        -:   29:
      501:   30:    for (int i = 0; i < MAX_TESTS; i++) {
branch  0 taken 99%
branch  1 taken 1% (fallthrough)
        -:   31:
        -:   32:	//randomly initialize variables
      500:   33:        players = rand() % (MAX_PLAYERS - 2) + 2;
call    0 returned 100%
      500:   34:        seed = rand();
call    0 returned 100%
      500:   35:        coinBonus = 0;
      500:   36:        handPos = rand() % 4;
call    0 returned 100%
      500:   37:        player = i % (players);
      500:   38:	int test_status = 1; 	
      500:   39:        initializeGame(players, k, seed, &game); //initialize game
call    0 returned 100%
        -:   40:
        -:   41:        // Initiate valid state variables
      500:   42:        game.deckCount[player] = rand() % MAX_DECK;   //Pick random deck size out of MAX DECK size
call    0 returned 100%
      500:   43:        game.discardCount[player] = rand() % MAX_DECK;
call    0 returned 100%
      500:   44:        game.handCount[player] = rand() % MAX_HAND;
call    0 returned 100%
        -:   45:      
      500:   46:	int discardCount1 = game.discardCount[player]; 
      500:   47:	int deckCount1 = game.deckCount[player];
        -:   48:	 
        -:   49:	//grab hand count numbers before calling the card
      500:   50:	int handCount1 = numHandCards(&game);
call    0 returned 100%
        -:   51: 
        -:   52:	//check if cardEffect is working properly
      500:   53:        if(cardEffect(smithy, choice1, choice2, choice3, &game, 0, 0) == 0){
call    0 returned 100%
branch  1 taken 100% (fallthrough)
branch  2 taken 0%
        -:   54:
        -:   55:	//grab hand count after calling card
      500:   56:	int handCount2 = numHandCards(&game); 
call    0 returned 100%
      500:   57:	int discardCount2 = game.discardCount[player];
      500:   58:        int deckCount2 = game.deckCount[player];
        -:   59:
        -:   60:		//check to see if hand count changed properly
      500:   61:		if(handCount2 != (handCount1 + 3 - 1)) {
branch  0 taken 0% (fallthrough)
branch  1 taken 100%
    #####:   62:			printf("Error: Incorrect number of cards drawn\n"); 	
call    0 never executed
    #####:   63:			printf("Hand count before: %d. Hand count after %d.\n", handCount1, handCount2 ); 
call    0 never executed
    #####:   64:			test_failed++; 
    #####:   65:			test_status= 0; //set test state to failed
        -:   66:		}
      500:   67:		 if(deckCount2 != deckCount1 - 3 || deckCount2 != deckCount1) 
branch  0 taken 40% (fallthrough)
branch  1 taken 60%
branch  2 taken 100% (fallthrough)
branch  3 taken 0%
        -:   68:                {
      500:   69:                        printf("Error: Incorrect number of cards in deck\n");
call    0 returned 100%
      500:   70:                        printf("Deck count before: %d. Deck count after %d.\n", deckCount1, deckCount2 );
call    0 returned 100%
      500:   71:                        printf("Change of: %d\n", (deckCount2 - deckCount1)); 
call    0 returned 100%
      500:   72:			test_failed++;
      500:   73:                        test_status= 0; //set test state to failed
        -:   74:
        -:   75:                }
      500:   76:                if(discardCount2 != discardCount1){
branch  0 taken 1% (fallthrough)
branch  1 taken 99%
        1:   77:                        printf("Error: Incorrect number of cards discarded\n");
call    0 returned 100%
        1:   78:                        printf("Discard count before: %d. discard count after %d.\n", discardCount1, discardCount2 );
call    0 returned 100%
        1:   79:                        printf("Change of: %d\n", (discardCount2 - discardCount1));
call    0 returned 100%
        1:   80:			test_failed++;
        1:   81: 	                test_status= 0; //set test state to failed		
        -:   82:		
        -:   83:		}
        -:   84:
      500:   85:	printf("Hand count before: %d. Hand count after %d.\n", handCount1, handCount2 );
call    0 returned 100%
      500:   86:	printf("Deck count before: %d. Deck count after %d.\n", deckCount1, deckCount2 );
call    0 returned 100%
      500:   87:	printf("Discard count before: %d. discard count after %d.\n", discardCount1, discardCount2 );
call    0 returned 100%
        -:   88:
        -:   89:	}
        -:   90:	// if card effect failed, print error
        -:   91:	else {
    #####:   92:		printf("Error: card could not be properly played\n"); 
call    0 never executed
    #####:   93:		test_status = 0; //set test state to failed
    #####:   94:		test_failed++; 
        -:   95:	}
        -:   96:
      500:   97:	if(test_status == 0){
branch  0 taken 100% (fallthrough)
branch  1 taken 0%
      500:   98:                printf("Iteration %d: test failed\n", i);
call    0 returned 100%
        -:   99:        }
        -:  100:        else {
    #####:  101:                printf("Iteration %d: test passed \n", i);
call    0 never executed
        -:  102:        }
        -:  103:	
        -:  104:
        -:  105:
        -:  106:    }	
        1:  107:    if(test_failed > 0){
branch  0 taken 100% (fallthrough)
branch  1 taken 0%
        1:  108:	printf("Smithy card failed %d random tests\n", test_failed);	
call    0 returned 100%
        -:  109:    }		
        -:  110:    else {
    #####:  111:	printf("Smithy card passed all random tests\n"); 
call    0 never executed
        -:  112:    }	
        -:  113:
        1:  114:    return 0;
        -:  115:}
